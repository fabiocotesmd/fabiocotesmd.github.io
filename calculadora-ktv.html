<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora KT/V - Dr. Fabio Cotes</title>
    <link rel="stylesheet" href="../assets/css/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        .calculator-container {
            max-width: 800px;
            margin: 0 auto;
        }
        
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--accent-color);
        }
        
        .form-group input, .form-group select {
            width: 100%;
            padding: 0.8rem;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }
        
        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: var(--primary-color);
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }
        
        .calculate-btn {
            width: 100%;
            padding: 1rem;
            background-color: var(--accent-color);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.3s ease;
            margin: 1rem 0;
        }
        
        .calculate-btn:hover {
            background-color: #2c7a62;
        }
        
        .results-section {
            background-color: var(--secondary-color);
            padding: 2rem;
            border-radius: 10px;
            margin-top: 2rem;
            display: none;
        }
        
        .result-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.8rem 0;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .result-item:last-child {
            border-bottom: none;
        }
        
        .result-value {
            font-weight: bold;
            font-size: 1.2rem;
            color: var(--accent-color);
        }
        
        .interpretation {
            background-color: var(--white);
            padding: 1.5rem;
            border-radius: 8px;
            margin-top: 1rem;
        }
        
        .adequate {
            border-left: 4px solid #28a745;
        }
        
        .inadequate {
            border-left: 4px solid #dc3545;
        }
        
        .theory-section {
            background-color: var(--white);
            padding: 2rem;
            border-radius: 10px;
            margin-bottom: 2rem;
            box-shadow: var(--shadow);
        }
        
        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="logo">
            <h1>Dr. Fabio Cotes</h1>
            <p>Médico y Cirujano, Hemodialista</p>
        </div>
        <nav>
            <ul>
                <li><a href="../index.html">Inicio</a></li>
                <li><a href="../colegas.html" class="active">Para Colegas</a></li>
                <li><a href="../pacientes.html">Para Pacientes</a></li>
                <li><a href="../personal.html">Espacio Personal</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <section class="page-header">
            <h1>Calculadora KT/V</h1>
            <p>Cálculo de la dosis de diálisis según el método de Daugirdas</p>
        </section>

        <div class="calculator-container">
            <section class="content-section">
                <div class="section-header">
                    <i class="fas fa-calculator"></i>
                    <h2>Calculadora</h2>
                </div>
                
                <form id="ktvCalculator">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="urea-pre">Urea pre-diálisis (mg/dL):</label>
                            <input type="number" id="urea-pre" step="0.1" placeholder="Ej: 120.5" required>
                        </div>
                        <div class="form-group">
                            <label for="urea-post">Urea post-diálisis (mg/dL):</label>
                            <input type="number" id="urea-post" step="0.1" placeholder="Ej: 35.2" required>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="tiempo">Tiempo de sesión (horas):</label>
                            <input type="number" id="tiempo" step="0.1" placeholder="Ej: 4.0" required>
                        </div>
                        <div class="form-group">
                            <label for="ultrafiltracion">Ultrafiltración (litros):</label>
                            <input type="number" id="ultrafiltracion" step="0.1" placeholder="Ej: 2.5" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="peso-post">Peso post-diálisis (kg):</label>
                        <input type="number" id="peso-post" step="0.1" placeholder="Ej: 70.5" required>
                    </div>

                    <button type="submit" class="calculate-btn">
                        <i class="fas fa-calculator"></i> Calcular KT/V
                    </button>
                </form>

                <div id="results" class="results-section">
                    <h3><i class="fas fa-chart-line"></i> Resultados</h3>
                    
                    <div class="result-item">
                        <span>Razón de Reducción de Urea (URR):</span>
                        <span class="result-value" id="urr-value">-</span>
                    </div>
                    
                    <div class="result-item">
                        <span>KT/V (Daugirdas):</span>
                        <span class="result-value" id="ktv-value">-</span>
                    </div>
                    
                    <div id="interpretation" class="interpretation">
                        <h4><i class="fas fa-stethoscope"></i> Interpretación clínica</h4>
                        <p id="interpretation-text">-</p>
                    </div>
                </div>
            </section>

            <section class="theory-section">
                <div class="section-header">
                    <i class="fas fa-info-circle"></i>
                    <h2>Fundamento teórico</h2>
                </div>
                <p><strong>KT/V</strong> es un parámetro que mide la dosis de diálisis administrada a un paciente. Representa la fracción del volumen de distribución de la urea que ha sido depurada durante una sesión de hemodiálisis.</p>
                
                <h3>Componentes:</h3>
                <ul style="list-style-type: disc; margin-left: 2rem; margin-top: 1rem;">
                    <li><strong>K:</strong> Clearance de urea del dializador (ml/min)</li>
                    <li><strong>T:</strong> Tiempo de diálisis (minutos)</li>
                    <li><strong>V:</strong> Volumen de distribución de la urea (ml)</li>
                </ul>

                <h3>Fórmula de Daugirdas (Segunda generación):</h3>
                <div style="background-color: var(--secondary-color); padding: 1rem; border-radius: 8px; margin: 1rem 0; text-align: center; font-weight: bold;">
                    KT/V = -ln(R - 0.008 × t) + (4 - 3.5 × R) × UF/P
                </div>
                
                <p><strong>Donde:</strong></p>
                <ul style="list-style-type: disc; margin-left: 2rem;">
                    <li><strong>R:</strong> Razón de reducción de urea (URR) = Urea post / Urea pre</li>
                    <li><strong>t:</strong> Tiempo de sesión en horas</li>
                    <li><strong>UF:</strong> Volumen de ultrafiltración (litros)</li>
                    <li><strong>P:</strong> Peso post-diálisis (kg)</li>
                    <li><strong>ln:</strong> Logaritmo natural</li>
                </ul>

                <h3>Valores objetivo:</h3>
                <ul style="list-style-type: disc; margin-left: 2rem;">
                    <li><strong>KT/V ≥ 1.2:</strong> Adecuado para hemodiálisis tres veces por semana</li>
                    <li><strong>KT/V < 1.2:</strong> Inadecuado, requiere ajuste de prescripción</li>
                </ul>
            </section>
        </div>
    </main>

    <footer>
        <div class="footer-content">
            <div class="footer-info">
                <p>&copy; 2025 Dr. Fabio Cotes - Todos los derechos reservados</p>
            </div>
            <div class="footer-nav">
                <a href="../index.html">Inicio</a>
                <a href="../colegas.html">Para Colegas</a>
                <a href="../pacientes.html">Para Pacientes</a>
                <a href="../personal.html">Espacio Personal</a>
            </div>
        </div>
    </footer>

    <script>
        document.getElementById('ktvCalculator').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Obtener valores del formulario
            const ureaPre = parseFloat(document.getElementById('urea-pre').value);
            const ureaPost = parseFloat(document.getElementById('urea-post').value);
            const tiempo = parseFloat(document.getElementById('tiempo').value);
            const ultrafiltracion = parseFloat(document.getElementById('ultrafiltracion').value);
            const pesoPost = parseFloat(document.getElementById('peso-post').value);
            
            // Validaciones básicas
            if (ureaPost >= ureaPre) {
                alert('La urea post-diálisis debe ser menor que la pre-diálisis');
                return;
            }
            
            if (tiempo <= 0 || pesoPost <= 0) {
                alert('El tiempo y el peso deben ser valores positivos');
                return;
            }
            
            // Calcular URR
            const urr = ((ureaPre - ureaPost) / ureaPre * 100);
            const R = ureaPost / ureaPre;
            
            // Calcular KT/V usando la fórmula de Daugirdas
            const ktv = -Math.log(R - 0.008 * tiempo) + (4 - 3.5 * R) * (ultrafiltracion / pesoPost);
            
            // Mostrar resultados
            document.getElementById('urr-value').textContent = urr.toFixed(1) + '%';
            document.getElementById('ktv-value').textContent = ktv.toFixed(2);
            
            // Interpretación
            const interpretationDiv = document.getElementById('interpretation');
            const interpretationText = document.getElementById('interpretation-text');
            
            if (ktv >= 1.2) {
                interpretationDiv.className = 'interpretation adequate';
                interpretationText.innerHTML = `
                    <strong>✅ Dosis de diálisis ADECUADA</strong><br>
                    El KT/V de ${ktv.toFixed(2)} cumple con las recomendaciones internacionales (≥1.2) para hemodiálisis tres veces por semana.
                    La URR de ${urr.toFixed(1)}% también indica una buena depuración de toxinas urémicas.
                `;
            } else {
                interpretationDiv.className = 'interpretation inadequate';
                interpretationText.innerHTML = `
                    <strong>⚠️ Dosis de diálisis INADECUADA</strong><br>
                    El KT/V de ${ktv.toFixed(2)} está por debajo del objetivo recomendado (≥1.2). 
                    Considerar: aumentar el tiempo de sesión, mejorar el flujo sanguíneo, usar un dializador de mayor superficie, 
                    o verificar el acceso vascular.
                `;
            }
            
            // Mostrar sección de resultados
            document.getElementById('results').style.display = 'block';
            document.getElementById('results').scrollIntoView({ behavior: 'smooth' });
        });
    </script>
</body>
</html>